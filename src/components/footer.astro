---
import Wrapper from "~/components/wrapper.astro";

const links = [
  { text: "~", href: "/" },
  { text: "about", href: "/about" },
  { text: "notes", href: "/notes" },
  { text: "syndications", href: "/syndications" },
  { text: "photos", href: "/photos" },
  {
    text: "rss",
    href: import.meta.env.DEV ? `/rss.xml?${Date.now()}` : "/rss.xml",
  },
  {
    text: "stats",
    href: "https://cloud.umami.is/share/tNl4j2DN3BMN3xwq/pwnwriter.me",
  },
];
---

<Wrapper>
  <footer class="py-md text-center font-mono">
    <nav class="flex flex-wrap justify-center gap-2">
      {
        links.map(({ text, href }) => {
          const isExternal = href.startsWith("http");
          return (
            <a
              href={href}
              rel={isExternal ? "external" : undefined}
              target={isExternal ? "_blank" : undefined}
              class="footer-chip"
            >
              {text}
            </a>
          );
        })
      }
      <button id="theme-toggle" class="footer-chip" type="button">theme</button>
    </nav>

    <p class="mt-4 text-xs text-f-low opacity-50">
      &copy; {new Date().getFullYear()} pwnwriter
    </p>
  </footer>
</Wrapper>

<style>
  .footer-chip {
    display: inline-block;
    padding: 0.2rem 0.65rem;
    font-size: 0.72rem;
    color: var(--f-low);
    border: 1px solid color-mix(in srgb, var(--accent) 20%, transparent);
    border-radius: 2px;
    text-decoration: none;
    transition:
      border-color 0.2s,
      color 0.2s;
  }

  .footer-chip:hover {
    border-color: var(--accent);
    color: var(--accent);
  }

  /* desktop has the keyboard indicator, so hide this */
  @media (min-width: 1024px) {
    #theme-toggle {
      display: none;
    }
  }
</style>

<script>
  // cycle: system → dark → light → system
  document.getElementById("theme-toggle")?.addEventListener("click", () => {
    const root = document.documentElement;
    const current = localStorage.getItem("theme") || "system";

    if (current === "system") {
      root.classList.add("dark");
      localStorage.setItem("theme", "dark");
    } else if (current === "dark") {
      root.classList.remove("dark");
      root.classList.add("light");
      localStorage.setItem("theme", "light");
    } else {
      root.classList.remove("light");
      localStorage.setItem("theme", "system");
    }
  });
</script>
